<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<link rel="stylesheet" type="text/css" href="css/login2.css">
<script src="js/jquery-3.1.0.js"></script>
<body>
<div class="logo">
    <div class="logo1"><a href="#"><img src="images/logo.jpg" /></a>
        <span >欢迎注册</span>
    </div>
</div>
<div class="logo2">
    <div class="logo2_1">
        <div class="logo2_pic"><a href="#"><img src="images/loginPic.jpg"/> </a></div>
        <div class="logo2_onload">
            <ul class="text1">
                <li class="tel" id="t1"><a href="#"id="sjzc">手机注册</a></li>
                <li class="tel" id="t2"><a href="#" id="yxzc">邮箱注册</a></li>
                <li class="tel" style="border: none;float: right;">已有账号！ <a href="login_1.html"style="color: red">登录</a> </li>
            </ul>
            <div class="b_onload1">

                <div class="bb0" >
                    <div class="div1">
                    <div class="text4">
                        <input  id="onload_name" class="txtname" type="text" value="" placeholder="手机号"  />
                        <a class="user2"></a>
                    </div>
                    <div class="text4">
                        <input  id="onload_password1" class="txtpassword" type="password" value=""placeholder=" 密码"/>
                        <a class="password1"></a>
                    </div>
                    <div class="text4">
                        <input  id="onload_password2" class="txtpassword1" type="password"value="" placeholder=" 确认密码"/>
                        <a class="password2"></a>
                    </div>
                    </div>
                    <div class="text5">
                        <input  id="onload_tel" type="text" value="" placeholder="手机验证码" /><input type="button" value="获取手机验证码" style="font-size: 14px;text-align: center;"  />
                    </div>
                </div>
                <div class="bb1" >
                    <div class="div1">
                        <div class="text4">
                            <input  id="onload_e_name" class="txtname" type="text" placeholder="E-mail" value=""  />
                            <a class="user2"></a>
                        </div>
                        <div class="text4">
                            <input  id="onload_e_password1" class="txtpassword" value="" type="password" placeholder="密码"/>
                            <a class="password1"></a>
                        </div>
                        <div class="text4">
                            <input  id="onload_e_password2" class="txtpassword1" value="" type="password" placeholder="确认密码"/>
                            <a class="password2"></a>
                        </div>
                        </div>
                        <div class="text5">
                            <input  id="onload_e_tel" type="text" value="" placeholder="邮箱验证码" /><input type="button" value="获取邮箱验证码" style="font-size: 14px;text-align: center;"  />
                        </div>
                </div>

                <div class="text2">
                    <input id="check" type="checkbox" checked="checked" style="float: left"/>
                    <p>我已看过并接受<a href="#" style="color: blue">《用户协议》</a></p>
                </div>
                <div class="text3">
                   <input type="button" value="立即注册" id="bt1"/>
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="foot">
        <div class="foot1">
            <div class="foot1_1">
                <ul>
                    <li><a href="#">关于我们</a> </li>
                    <li><a href="#">联系我们</a> </li>
                    <li><a href="#">友情链接</a> </li>
                    <li style="border: none;"><a href="#">帮助中心</a> </li>
                </ul>
            </div>
            <div class="foot1_2">
                <p>ICP备案证书号：豫ICP备16005952号 &copy;2015-2016 美货到水果商城 版权所有，并保留所有权利。</p>
            </div>
            <div class="foot1_3">
                <p>客服热线：400—6622-861 E-mail:vip@meihuodao.com<span><img src="images/login_foot_1.gif"></span><img src="images/login_foot_2.gif"/> <a href="#">81709669</a><img src="images/login_foot_2.gif"/> <a href="#">81709669</a></p>
            </div>
        </div>

    </div>


<script>
    $("#sjzc").on("click",function () {
        $(".bb0").css({"display":"block"});
        $(".bb1").css({"display":"none"});
    });

    $("#yxzc").on("click",function () {
        $(".bb1").css({"display":"block"});
        $(".bb0").css({"display":"none"});
    });

    $("#t1").on("click",function () {

        $(this).css({"border":"2px solid #d0d6d6","border-bottom":"none","font-weight":"600"});
        $("#t2").css({"border":"none","font-weight":"100"})
    });
    $("#t2").on("click",function () {
        $(this).css({"border":"2px solid #d0d6d6","border-bottom":"none","font-weight":"600"});
        $("#t1").css({"border":"none","font-weight":"100"})
    });


   $(".txtname").blur(function () {
        if($(this).val()==""){
            $(".text4 .user2").html("*用户名不能为空！");
            $(".text4 .user2").css({"color":"red"})
            $(".txtname").css({"border-color":"pink"})

        }else {
            var isrc=$("<script src='http://localhost:8080/user/CheckUserNameGet?username="+$(this).val()+"&callback=fn1'><\/script>");
            /*var isrc=("<script><\/script>");
             isrc.src=("http://10.9.163.115:8081/user/CheckUserNameGet?username="+$(this).val()+"&callback=fn1");
            $("body").append(isrc);*/
            $("body").append(isrc);
        }
    });

    function fn1(result) {
        if (result==1){
            $(".text4 .user2").html("*用户名已注册，请重新输入！");
            $(".text4 .user2").css({"color":"red"})
            $(".txtname").css({"border-color":"pink"})
        }else {
            $(".text4 .user2").html("*可注册用户名^-^");
            $(".text4 .user2").css({"color":"lightgreen"})
            $(".txtname").css({"border-color":"lightgreen"})
        }
    }
    $(".txtpassword").blur(function () {
        if($(this).val()==""){
             $(".text4 .password1").html("*密码不能为空！");
            $(".text4 .password1").css({"color":"red"})
            $(".txtpassword").css({"border-color":"pink"})
        }else if($(this).val().length<=5||$(this).val().length>=15){
            $(".text4 .password1").html("*请输入6-14位的密码！");
            $(".text4 .password1").css({"color":"red"})
            $(".txtpassword").css({"border-color":"pink"})
        }else {
            $(".text4 .password1").html("");
            $(".text4 .password1").css({"color":"red"})
            $(".txtpassword").css({"border-color":"lightgreen"})
        }
    })
    $(".txtpassword1").blur(function () {
        if($(this).val()==""){
            $(".text4 .password2").html("*请确认您的密码！");
            $(".text4 .password2").css({"color":"red"})
            $(".txtpassword1").css({"border-color":"pink"})
        }else
            if($(this).val()!=$(".txtpassword").val()){
                $(".text4 .password2").html("*两次密码输入不一致，请重新确认！");
                $(".text4 .password2").css({"color":"red"})
                $(".txtpassword1").css({"border-color":"pink"});
                $(".txtpassword").css({"border-color":"pink"});
            }else {
                $(".text4 .password2").html("");
                $(".txtpassword1").css({"border-color":"lightgreen"});
                $(".txtpassword").css({"border-color":"lightgreen"});
            }
    })
    $("#bt1").on("click",function () {
        var x=$(".txtpassword").val();

        var n=$(".txtname").val();
        var oDiv1 = document.getElementsByClassName("div1");
        if(!$("#check").prop("checked")){
            alert("请认真阅读《用户协议》并同意方可注册用户！")
        }else{
            var xhr;
            if (window.XMLHttpRequest) {
                xhr = new XMLHttpRequest();
            } else {
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4) {
                    if (xhr.status == 200) {
                        //var arrUser = eval("(" + xhr.responseText + ")");
                        oDiv1.innerHTML = xhr.responseText;
                        alert("注册成功！");
                        window.location.href="login_1.html";
                    } else {
                        alert("失败");
                    }
                }
            }
           /* xhr.open("post", "http://localhost:8080/user/CheckUserName", true);
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send("username=gao&callback=fn3");*/
            xhr.open("POST", "http://localhost:8080/user/register?name="+n+"&password="+x+"&callback=fn5", true);
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send();
        }

    });
/*    function fn5(result) {
        if(result==1){
            alert("成功")
        }else {
            alert("shibai")
        }
    }*/



</script>
</body>

</html>